{% extends 'base.html' %}

{% block title %}Dashboard - Budget Tracker{% endblock %}

{% block content %}
    <div class="mb-4">
        <h2 style="font-family: 'Poppins', sans-serif; font-weight: 700; color: var(--text-primary); margin-bottom: 8px;">Dashboard</h2>
        <p style="color: var(--text-secondary);">Welcome back! Here's your financial overview.</p>
    </div>

    <!-- Summary Cards -->
    <div class="row mb-4">
        <div class="col-md-4 mb-3">
            <div class="stats-card success">
                <div class="stats-label">Total Income</div>
                <div class="stats-value">${{ "%.2f"|format(total_income) }}</div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="stats-card danger">
                <div class="stats-label">Total Expenses</div>
                <div class="stats-value">${{ "%.2f"|format(total_expense) }}</div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="stats-card {% if balance >= 0 %}info{% else %}danger{% endif %}">
                <div class="stats-label">Balance</div>
                <div class="stats-value">${{ "%.2f"|format(balance) }}</div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="mb-4" style="display: flex; gap: 12px; flex-wrap: wrap;">
        <a href="{{ url_for('main.add_income') }}" class="btn btn-success">‚ûï Add Income</a>
        <a href="{{ url_for('main.add_expense') }}" class="btn btn-danger">‚ûñ Add Expense</a>
        <a href="{{ url_for('main.graph') }}" class="btn btn-primary">üìä View Graphs</a>
        <a href="{{ url_for('main.view_groups') }}" class="btn btn-secondary">üë• Groups</a>
        <a href="{{ url_for('main.export') }}" class="btn btn-secondary">üìÅ Export Data</a>
    </div>

    <!-- Incomes Table -->
    <div class="card mb-4">
        <div class="card-header">
            Your Incomes
        </div>
        <div class="card-body">
            {% if incomes %}
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Amount</th>
                            <th>Source</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Recurring</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for income in incomes %}
                        <tr>
                            <td style="font-weight: 600; color: var(--success-color);">${{ "%.2f"|format(income.amount) }}</td>
                            <td>{{ income.source }}</td>
                            <td style="color: var(--text-secondary);">{{ income.description or '-' }}</td>
                            <td>{{ income.date.strftime('%Y-%m-%d') if income.date else '-' }}</td>
                            <td>
                                {% if income.is_recurring %}
                                    <span class="badge" style="background: var(--info-color); color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px;">{{ income.frequency|title }}</span>
                                {% else %}
                                    <span class="badge" style="background: var(--text-secondary); color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px;">No</span>
                                {% endif %}
                            </td>
                            <td>
                                <div style="display: flex; gap: 8px;">
                                    <a href="{{ url_for('main.edit_income', income_id=income.id) }}" class="btn btn-sm btn-primary">Edit</a>
                                    <form method="POST" action="{{ url_for('main.delete_income', income_id=income.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this income?');">
                                        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                <p style="margin-bottom: 16px;">No income records yet.</p>
                <a href="{{ url_for('main.add_income') }}" class="btn btn-success">Add Your First Income</a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Expenses Table -->
    <div class="card">
        <div class="card-header">
            Your Expenses
        </div>
        <div class="card-body">
            {% if expenses %}
            <div class="table-responsive">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Amount</th>
                            <th>Category</th>
                            <th>Description</th>
                            <th>Date</th>
                            <th>Recurring</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for expense in expenses %}
                        <tr>
                            <td style="font-weight: 600; color: var(--danger-color);">${{ "%.2f"|format(expense.amount) }}</td>
                            <td><span class="badge" style="background: var(--primary-color); color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px;">{{ expense.category }}</span></td>
                            <td style="color: var(--text-secondary);">{{ expense.description or '-' }}</td>
                            <td>{{ expense.date.strftime('%Y-%m-%d') if expense.date else '-' }}</td>
                            <td>
                                {% if expense.is_recurring %}
                                    <span class="badge" style="background: var(--info-color); color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px;">{{ expense.frequency|title }}</span>
                                {% else %}
                                    <span class="badge" style="background: var(--text-secondary); color: white; padding: 4px 8px; border-radius: 6px; font-size: 11px;">No</span>
                                {% endif %}
                            </td>
                            <td>
                                <div style="display: flex; gap: 8px;">
                                    <a href="{{ url_for('main.edit_expense', expense_id=expense.id) }}" class="btn btn-sm btn-primary">Edit</a>
                                    <form method="POST" action="{{ url_for('main.delete_expense', expense_id=expense.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this expense?');">
                                        <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div style="text-align: center; padding: 40px; color: var(--text-secondary);">
                <p style="margin-bottom: 16px;">No expense records yet.</p>
                <a href="{{ url_for('main.add_expense') }}" class="btn btn-danger">Add Your First Expense</a>
            </div>
            {% endif %}
        </div>
    </div>
{% endblock %}
